# Sower

A Ruby gem to simplify Seed data creation for Rails applications.

## Installation

Add it to your Gemfile:

```ruby
gem 'sower'
```

Run the following command to install it:

```console
bundle install
```

Run the generator:

```console
rails generate sower:install
```

## Usage

### Creating Seed Data

Seed data is created by placing files in the `db/sower_data` directory. The files should be named after the model they are creating data for. For example, a file named `users.json` would create seed data for the `User` model.

`db/sower_data/users.json`

### Translating Seed Data

You will need to define a sower file to take the data parsed from your seed data and turn create the records in your database.

Sower files should be created in `app/seeds/sower`. The files should be named after the model they are creating data for. For example, a file named `user.rb` would create seed data for the `User` model.

In `db/sower_data/users.json`
```json
[
  {
    "first_name": "John",
    "last_name": "Doe",
    "email": "john.doe@example.com"
  },
  {
    "first_name": "Jane",
    "last_name": "Doe",
    "email": "jane.doe@example.com"
  }
]
```

In `app/seeds/sower/user.rb`
```ruby
# frozen_string_literal: true

module Sower
  class User < Sower::Base
    def load!
      ::User.find_or_create_by!(
        first_name: @data[:first_name],
        last_name: @data[:last_name],
        email: @data[:last_name]
      )
    end
  end
end
```

### Loading Seed Data

Seeds can be generated by calling the `seed!` method on `Sower`.

It takes one or more symbol arguments that correspond to sets of seed data and runs then in the order passed.

`Sower.seed!(:users, :organizations, :facilities)`

## Adapters

Sower defaults to loading yml files, but can be configured to load json, csv, or tsv files. This can be configured in `config/initializers/sower.rb`. (Can be generated by running `rails generate sower:install`)

```ruby
Sower.setup do |config|
  config.adapter = :json
end
```
